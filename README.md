# Causal Regularization

Files for reproducing the simulation and experimental sections of **Causal
Regularization: A trade-off between in-sample risk
and out-of-sample risk guarantees**.

### Install required packages

The source code was developed with R version 4.4.2. Execute the following
command to install the necessary packages

```
Rscript requirements.R
```

## Simulations and experiments

To reproduce the figures presented in the paper, please execute the
following commands.

### Simulation with increasing sample size (Section 6.1 and Appendix E.1)

The following command can be used to generate figures 2, 3, 5, 12 and 13 in the
paper.

```
Rscript ./experiments/simulation/increasing_sample.R --shiftTarget=0 \
                                                     --inSampleShift=5 
```

The following table summarizes the parameters:

| Parameter       | Description                                                                                                                  | Corresponding term in the article |
|-----------------|------------------------------------------------------------------------------------------------------------------------------|-----------------------------------|
| `inSampleShift` | Scale of the in-sample distribution shift                                                                                    | $\gamma_1$ in Equation (7)        |
| `shiftTarget`   | Scale of the distribution shift in the target variable. If it equals zero, then the target variable is not directly shifted. | $\gamma_2$ in Equation (24)       |

Figures 2, 3, and 5 are generated by running:

```
Rscript ./experiments/simulation/increasing_sample.R --shiftTarget=0 \
                                                     --inSampleShift=5
```

Figure 12 is generated by running:

```
Rscript ./experiments/simulation/increasing_sample.R --shiftTarget=0.25 \
                                                     --inSampleShift=5
```

Figure 13 is generated by running:

```
Rscript ./experiments/simulation/increasing_sample.R --shiftTarget=0.5 \
                                                     --inSampleShift=5
```

### Simulation with increasing dimension (Section 6.2 and Appendix E.2)

The following command can generate figures 6, 14 and 15 in the paper.

```
Rscript ./experiments/simulation/increasing_dim.R --shiftTarget=0 \
                                                  --inSampleShift=5 \
                                                  --outOfSampleShift=100
```

The parameters are the same as in the previous section, with the addition of:

| Parameter          | Description                                   | Corresponding term in the article |
|--------------------|-----------------------------------------------|-----------------------------------|
| `outOfSampleShift` | Scale of the out-of-sample distribution shift | $\gamma_1$ in Equation (7)        |

Figure 6 is generated by running:

```
Rscript ./experiments/simulation/increasing_sample.R --shiftTarget=0 \
                                                     --inSampleShift=5 \
                                                     --outOfSampleShift=100
```

Figure 14 is generated by running:

```
Rscript ./experiments/simulation/increasing_sample.R --shiftTarget=0.25 \
                                                     --inSampleShift=5 \
                                                     --outOfSampleShift=100
```

Figure 15 is generated by running:

```
Rscript ./experiments/simulation/increasing_sample.R --shiftTarget=0.5 \
                                                     --inSampleShift=5 \
                                                     --outOfSampleShift=100
```

### Light tunnel experiment (Section 7)

Running the following command generates figures 8, 9, and 10 in the paper.

```

Rscript ./experiments/chamber/chamber.R

```

The following table summarizes the parameters:

| Parameter    | Description                                                   |
|--------------|---------------------------------------------------------------|
| `foldsForCV` | Determines the number of folds to be used by cross-validation |

### Fulton Fisher Market experiment (Appendix F.1)

Running the following command generates figures 16 and 17 in the paper.

```

Rscript ./experiments/fish/fish.R

```

### Gene knockout experiments (Appendix F.2)

Running the following command generates Figure 18 in the paper.

```

Rscript ./experiments/genes/genes.R

```